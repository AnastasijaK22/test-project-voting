# Test-project-voting

Клиент-серверное приложение, которое позволяет создавать голосование в
различных разделах.

Приложение поддерживает: 
  - Запуск в режиме клиента и режиме сервера;
  - Общение по протоколу TCP между сервером и клиентом;
  - В режиме сервера уметь принимать команды от нескольких клиентов одновременно.
  
Клиентские команды:
  - `login -u=username` – подключиться к серверу с указанным именем пользователя (все остальные команды доступны только после выполнения login),
  - `create topic -n=<topic>` - создает новый раздел c уникальным именем заданным в параметре -n,
  - `view -t` - показывает список всех созданных разделов в формате: <nameTopic (votes in topic=<count>)>,
  - `view -t=<topic>` - показывает список уже созданных голосований в формате: <topic (votes in topic=<count>)>,
  - `create vote -t=<topic>` - запускает создание нового голосования в разделе указанном в параметре -t.
    Для создания голосования (команда create vote -t=<topic>) нужно последовательно запросить у пользователя: 
      * название (уникальное имя),
      * тему голосования (описание),
      * количество вариантов ответа,
      * варианты ответа;
  - `view -t=<topic> -v=<vote>` - отображает информацию по голосованию:
      * тема голосования,
      * варианты ответа и количество пользователей выбравших данный вариант;
  - `vote -t=<topic> -v=<vote>` - запускает выбор ответа в голосовании для текущего пользователя. Для этого приложение должно:
      * вывести варианты ответа для данного голосования,
      * запросить у пользователя выбор ответа;
  - `delete -t=topic -v=<vote>` - удалить голосование с именем <vote> из <topic> (удалить может только пользователь его создавший);
  - `exit` - завершение работы программы.
 
 Серверные команды:
  - `load <filename>` - загрузка данных из файла,
  - `save <filename>` – сохранение в файл всех созданных разделов и принадлежащим им голосований + их результатов,
  - `exit` - завершение работы программы.
  
## Запуск
По умолчанию использует база данных H2. В файле `application.properties` указаны свойства для работы с этой базой данных. Также запускалось приложение с использованием базы данных MySQL. Чтобы перенастроить проект на использование этой базы данных необходимо: 
  - В файле `pom.xml` раскомментировать зависимость, связанную с MySQL, и закомментировать зависимость для H2;
  - Скопировать свойства из файла `property for mysql.txt` и вставить в `application.properties`. Значения url, username, password требуется изменить на некоторые свои.
  
Для запуска приложения в режиме сервера необходимо запустить `main` в классе `TestProjectApplication`. После этого можно запускать в режиме клиента `main` в классе `Client`. 

## Использование
### Режим клиента

При некорректном вводе команд будет выдано сообщение `Incorrect input`.
```
create
Incorrect input
```
Название разделов и голосований необходимо вводить с использвание таких скобок <>:
```
view -t=<cats> -v=<Lesya>
```
При запуске необходимо залогиниться. Без этой команды все остальные будут недоступны (кроме `exit`, завершающей работу клиента).
```
create topic -n=<cats>
Access denied
```
После входа можно применять все остальные команды. 
Команды `create` проверяют существование создаваемых разделов и голосований. В случае существования будет выведено `Topic already exist`, `Vote already exist`, иначе раздел или голосование будет создано.

Команды `view`:
  - В случае остсутвия запрашиваемого раздела/голосования будет выведено `Topic don't exist`/`Vote don't exist`,
  - Пример работы `view -t`:
  ```
  view -t
  < cats (votes in topic 3)>
  < dragons (votes in topic 0)>
  ```
  - Пример работы `view -t=<topic>`:
  ```
  view -t=<cats>
  < cats
  1 Lesya
  2 cats
  3 cats vs dogs
  >
  ```
  - Пример работы `view -t=<topic> -v=<vote>`:
  ```
 view -t=<cats> -v=<Lesya>
  Topic : cats
  Name Vote: Lesya
  Description: About my cat Lesya
  Count Answers: 2
  Answers: [Answer: awful cat, Count Votes: 0, Answer: nice cat, Count Votes: 2]
  ```

Команда `vote`:
  - В случае остсутвия запрашиваемого раздела/голосования будет выведено `Topic don't exist`/`Vote don't exist`,
  - Выдает список доступных ответов в таком виде:
  ```
  vote -t=<cats> -v=<Lesya>
  1. awful cat
  2. nice cat
  ```
  Для выбора необходимо ввести нужный номер ответа. 1 или 2 в примере,
  - При успехе будет выведено сообщение `Your vote has been counted`.
  
Команда `delete`:
  - В случае остсутвия запрашиваемого раздела/голосования будет выведено `Topic don't exist`/`Vote don't exist`,
  - В случае, если пользователь не создатель голосования, будет выведено `User not creator`,  
  - При успехе будет выведено сообщение `Deleted succesfully`.
  
### Режим сервера
Сохранение данных происходит в файл с расширением `.bin` в папке `saves`. Файл для загрузки данных ищется в папке `saves`. 
Примеры: 
```
save <test>
Success save
load <test>
Success load
```
После работы будет создан файл `test.bin`. 

При вводе `exit` происходит завершение работы сервера.
